<table class="table">
  <thead>
  <tr>
    <th class="placeholder"></th>
    <th class="name">App Name
      <img [src]="sortIcon" alt="icon" class="icon-down" *ngIf="sortIcon">
      <fa-icon icon="angle-down" class="cursor-pointer angle" *ngIf="!sortIcon"></fa-icon>
    </th>
    <th class="summary">Summary</th>
    <th class="data">Data Added
      <img [src]="sortIcon" alt="icon" class="icon-down" *ngIf="sortIcon">
      <fa-icon icon="angle-down" class="cursor-pointer angle" *ngIf="!sortIcon"></fa-icon>
    </th>
    <th class="status">Status
      <img [src]="sortIcon" alt="icon" class="icon-down" *ngIf="sortIcon">
      <fa-icon icon="angle-down" class="cursor-pointer angle" *ngIf="!sortIcon"></fa-icon>
    </th>
    <th class="action"></th>
    <th class="placeholder"></th>
  </tr>
  </thead>
  <tbody>
  <ng-template [ngForOf]="properties.data.list" let-app ngFor>
    <tr>
      <td class="col-blank"></td>
      <td>
        <div class="row">
          <div class="col-md-auto cursor-pointer">
            <img [src]="app.customData.icon" alt="" class="app-icon">
          </div>
          <div class="col-md pl-0">
            <h6 class="mb-0 cursor-pointer pr-2 word-break">{{app.name}} </h6>
            <small> v {{app.version}}</small>
          </div>
        </div>
      </td>
      <td>
        <span class="summary-text">{{app.customData.summary ? app.customData.summary : ''}}</span>
      </td>
      <td>
        <span>{{app.created | date:'M/d/yyyy'}}</span>
      </td>
      <td>
        <small *ngIf="app.status.reason">
            <span [ngbPopover]="popContent"
                  class="cursor-pointer font-med text-primary" placement="bottom"
                  popoverClass="popover shadow-sm bg-white rounded"
                  popoverTitle="Status Change Reason"
                  triggers="hover">
                {{app.status.value | camelcase}}
            </span>
        </small>
        <ng-template #popContent>
          {{ app.status.reason }}
        </ng-template>
        <small *ngIf="!app.status.reason">
          <span class="cursor-pointer font-med text-primary">{{app.status.value | camelcase}}</span>
        </small>
      </td>
      <td>
        <ng-container [ngTemplateOutletContext]="{ $implicit: app }" [ngTemplateOutlet]="appMenuTemplate">
        </ng-container>
      </td>
      <td class="col-blank"></td>
    </tr>
<!--    <tr *ngFor="let child of app.childs">-->
<!--      <td class="col-blank"></td>-->
<!--      <td>-->
<!--        <div class="row">-->
<!--          <div (click)="action('edit' , child)" class="col-md-auto cursor-pointer">-->
<!--            <img alt="icon" class="px-3" src="assets/img/line-arrow-down.svg">-->
<!--            <img [src]="child.customData.icon" alt="" alt="" class="app-icon">-->
<!--          </div>-->
<!--          <div class="col-md pl-0">-->
<!--            <h6 (click)="action('edit' , child)"-->
<!--                class="mb-0 cursor-pointer pr-2 word-break">{{child.name}} </h6>-->
<!--            <small>v {{child.version}}</small>-->
<!--          </div>-->
<!--        </div>-->
<!--      </td>-->
<!--      <td>-->
<!--        <span class="summary-text">-->
<!--            {{child.customData['summary-plain-text'] != 'undefined' ? child.customData['summary-plain-text'] : ''}}-->
<!--        </span>-->
<!--      </td>-->
<!--      <td>-->
<!--        <span>{{child.created | date:'M/d/yyyy'}}</span>-->
<!--      </td>-->
<!--      <td>-->
<!--        <small *ngIf="child.prettyStatusReason">-->
<!--          <span [ngbPopover]="popContent"-->
<!--                class="cursor-pointer font-med text-primary" placement="bottom"-->
<!--                popoverClass="popover shadow-sm bg-white rounded"-->
<!--                popoverTitle="Status Change Reason"-->
<!--                triggers="hover">-->
<!--              {{child.prettyStatus}}-->
<!--          </span>-->
<!--        </small>-->
<!--        <ng-template #popContent>-->
<!--          {{ child.prettyStatusReason }}-->
<!--        </ng-template>-->
<!--        <small *ngIf="!child.prettyStatusReason"> <span-->
<!--                class="cursor-pointer font-med text-primary">{{child.prettyStatus}}</span>-->
<!--        </small>-->
<!--      </td>-->
<!--      <td>-->
<!--        <ng-container [ngTemplateOutletContext]="{ $implicit: child }" [ngTemplateOutlet]="appMenuTemplate">-->
<!--        </ng-container>-->
<!--      </td>-->
<!--      <td class="col-blank"></td>-->
<!--    </tr>-->
  </ng-template>
  <tr *ngIf="!properties.data.list || properties.data.list.length == 0">
    <td class="text-center" colspan="7">
      <span> No Applications Found</span>
    </td>
  </tr>
  <tr *ngIf="properties.data.list.length > 0">
    <td class="text-center pb-5" colspan="7">
      <span></span>
    </td>
  </tr>
  </tbody>
</table>

<ng-template #appMenuTemplate let-app>
  <div class="text-right ellipsis cursor-pointer">
    <div ngbDropdown placement="bottom-right">
      <img [src]="menuUrl" alt="more-icon" class="icon-dots" ngbDropdownToggle>
      <div ngbDropdownMenu>
        <ng-container *ngFor="let menuAction of properties.options">
          <button *ngIf="needToShowItem(menuAction, app?.status.value)"
                  (click)="action(menuAction, app?.appId, app?.version)"
                  ngbDropdownItem
                  class="menu" [ngClass]="'menu-' + menuAction | lowercase" >
            {{menuAction | titlecase}}
          </button>
        </ng-container>
      </div>
    </div>
  </div>
</ng-template>

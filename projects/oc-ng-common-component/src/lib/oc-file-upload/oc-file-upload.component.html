<div class="file-container without-files"  *ngIf="(!fileDetailArr || fileDetailArr.length == 0) ;else fileList" fileDragDrop
  (fileDropped)="onFileDropped($event,cropperModal)">
  <img [src]="uploadIconUrl" class="mb-2"
    alt="upload-icon">
  <input type="file" #fileDropRef id="fileDropRef" [accept]="getAcceptTypes()"
    (change)="fileBrowseHandler($event,cropperModal)" class="cursor-pointer"/>
  <div class="placeholder-text-container">
    <span class="d-block text-secondary font-m">{{fileUploadText}}</span>
    <span class="text-secondary font-m">or</span> <a class="font-m font-bold browse-file"  (click)="fileDropRef.click()" > Browse File</a>
  </div>
</div>

<ng-template #fileList>
  <div class="file-container">
    <div class="row">
      <div class="col-md">
        <p class="mb-3 font-med font-m">My Attachments</p>
      </div>
      <div class="col-md-auto" *ngIf="isMultiFileSupport()">
        <img [src]="uploadIconUrl" class="upload-s"
          alt="upload-icon">
        <a class="font-m font-bold browse-file" (click)="fileUploadRefid.click()">
          <input type="file" [accept]="getAcceptTypes()" #fileUploadRefid (change)="fileBrowseHandler($event,cropperModal)" style="display: none;"/>
          Browse File
        </a>
        <!-- <a href="#" *ngIf="isMultiFile || (!files || files.length == 0)">
          <input type="file" [accept]="acceptType" #fileUploadRefid (change)="fileBrowseHandler($event,cropperModal)" />
          <h5 class="blue-label float-right" style="display: inline;">Browse file</h5>
        </a> -->
      </div>
    </div>

    <div class="row" *ngFor="let file of fileDetailArr; let i = index" >
      <div class="col-md-auto pr-0">
        <img [src]="getUrl(file)" alt="app-icon" [ngClass]="file?.fileUploadProgress===100 ? 'app-icon':'default-icon'">
      </div>
      <div class="col-md-auto ml-n1">
        <span class="font-med font-m d-block">{{file.fileName}}</span>
        <span class="text-secondary font-s">{{file.fileUploadProgress===100 ? "Complete" : "Uploading"}}</span>
      </div>
      <div class="col-md text-right pt-3">
        <a (click)="cancelUploading(i)" class="cursor-pointer">
          <img src="assets/img/close-icon.svg"
          alt="close-icon">
        </a>
      </div>
      <div class="col-12 pt-1 mb-2 progressbar-wrapper">
        <ngb-progressbar class="file-upload-progress" type="info" *ngIf="file?.fileUploadProgress == 100" [value]="file?.fileUploadProgress">
        </ngb-progressbar>
        <ngb-progressbar class="file-upload-progress" type="primary" *ngIf="file?.fileUploadProgress < 100" [value]="file?.fileUploadProgress">
        </ngb-progressbar>
      </div>
      <!-- <div class="single-file" *ngFor="let file of files; let i = index">
        <div class="file-icon" style="width: 50px">
          <img [src]="getFileIcon(file)" style="max-width: 40px;">
        </div>
        <div class="info">
          <h4 class="name">
            {{ file?.fileName }}
          </h4>
          <oc-label text="{{file?.fileUploadProgress < 100 ? 'Uploading' : 'Complete'}}" class="label-s"></oc-label>
          <p class="size">
            {{ file?.size | fileSize }} - {{ fileDetail.uploadDate | date: 'dd MMM yyyy' }}
          </p>
          <p>
            <ngb-progressbar type="primary" *ngIf="file?.fileUploadProgress < 100" [value]="file?.fileUploadProgress">
            </ngb-progressbar>
          </p>
        </div>
        <div class="delete" (click)="deleteFile(i)">
          <span>X</span>
        </div>
        <hr>
      </div> -->
    </div>
  </div>
</ng-template>


<!--cropper modal for bulk edit-->
<ng-template #cropperModal let-c="close" let-d="dismiss">
  <div class="modal-header pb-0">
    <h4 class="modal-title">Edit Image</h4>
    <a class="close cursor-pointer" aria-describedby="modal-title" (click)="d('Cross click'); resetSelection()">
      <span aria-hidden="true">&times;</span>
    </a>
  </div>
  <div class="modal-body d-flex flex-column">
    <div class="file-cropper-body w-100 d-flex flex-column">
      <image-cropper [imageChangedEvent]="browsedFileEvent" [maintainAspectRatio]="maintainAspectRatio"
        [aspectRatio]="aspectRatio" [resizeToWidth]="resizeToWidth" [resizeToHeight]="resizeToHeight" format="png"
        (imageCropped)="imageCropped($event)" (imageLoaded)="imageLoaded()" (cropperReady)="cropperReady()"
        (loadImageFailed)="loadImageFailed()" [transform]="transform" style="padding: 0px;">
      </image-cropper>
      <!-- [resizeToWidth]="resizeToWidth"
          [resizeToHeight]="resizeToHeight" -->

      <div class="w-100 my-2 text-center" *ngIf="hasImageLoadError">
        {{ imageLoadErrorMessage }}
      </div>
      <div *ngIf="uploadImageInProcess" class="fileUploader-new">
        <div class="controls upload-progress">
          <div class="row">
            <div class="col">
              <div class="">
                {{fileName}}
              </div>
              <div class="progress">
                <div class="progress-bar" role="progressbar" [style.width.%]="[loaderValue]"
                  aria-valuenow="[loaderValue]" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer pr-0 pb-0">
        <div style="padding-top: 15px;padding-right: 15px;">
          <a class="cursor-pointer" (click)="zoomIn()" style="padding-right: 15px;"><i
              class="fa fa-search-plus"></i></a>
          <a class="cursor-pointer" (click)="zoomOut()"><i class="fa fa-search-minus"></i></a>
        </div>
        <oc-button type="secondary" [disabled]="uploadImageInProcess"
          (click)="d('Cross click'); resetSelection()" [text]="'Close'"></oc-button>
        <oc-button type="primary" [disabled]="hasImageLoadError || uploadImageInProcess"
          (click)="uploadImageFile();"
          [disabled]="uploadImageInProcess"
          [process]="uploadImageInProcess" [text]="'Upload'"
          ></oc-button>
      </div>
    </div>
  </div>
</ng-template>
<!--end cropper modal for bulk edit-->
<div (fileDropped)="onFileDropped($event,cropperModal)"
     *ngIf="(!fileDetailArr || fileDetailArr.length == 0) ;else fileList"
     class="file-container without-files"
     fileDragDrop>
    <img [src]="uploadIconUrl" alt="upload-icon"
         class="mb-2">
    <input #fileDropRef (change)="fileBrowseHandler($event,cropperModal)" [accept]="getAcceptTypes()"
           class="cursor-pointer"
           id="fileDropRef" type="file"/>
    <div class="placeholder-text-container">
        <span class="d-block text-secondary font-m">{{fileUploadText}}</span>
        <span class="text-secondary font-m">or</span> <a (click)="fileDropRef.click()"
                                                         class="font-m font-bold browse-file"> Browse File</a>
    </div>
</div>

<ng-template #fileList>
    <div class="file-container">
        <div class="row justify-content-center mb-3" *ngIf="isMultiFileSupport()">
            <div class="col-md-auto">
                <img [src]="uploadIconUrl" alt="upload-icon"
                     class="upload-s">
                <a (click)="fileDropRef.click()" class="font-m font-bold browse-file">
                    <input #fileDropRef (change)="fileBrowseHandler($event,cropperModal)" [accept]="getAcceptTypes()"
                           style="display: none;" type="file"/>
                    Browse File
                </a>
            </div>
        </div>

        <div *ngFor="let file of fileDetailArr; let i = index" class="row">
            <div class="col-md-auto pr-0">
                <img [ngClass]="getFileIconClass(file)" [src]="getUrl(file)" alt="app-icon">
            </div>
            <div *ngIf="file" class="col-md-auto ml-n1">
                <a (click)="downloadFile(file)" class="cursor-pointer"><span
                        class="font-med font-m d-block"> {{file.name}}</span></a>
                <span class="text-secondary font-s">{{file.fileUploadProgress === 100 ? "Complete" : "Uploading"}}</span>
            </div>
            <div *ngIf="file" class="col-md text-right pt-3">
                <a (click)="cancelUploading(i)" class="cursor-pointer">
                    <img alt="close-icon"
                         [src]="closeIconUrl">
                </a>
            </div>
            <div class="col-12 pt-1 mb-2 progressbar-wrapper">
                <ngb-progressbar *ngIf="file?.fileUploadProgress === 100" [value]="file?.fileUploadProgress"
                                 class="file-upload-progress"
                                 type="info">
                </ngb-progressbar>
                <ngb-progressbar *ngIf="file?.fileUploadProgress < 100" [value]="file?.fileUploadProgress"
                                 class="file-upload-progress"
                                 type="primary">
                </ngb-progressbar>
            </div>

        </div>
    </div>
</ng-template>


<!--cropper modal for bulk edit-->
<ng-template #cropperModal let-c="close" let-d="dismiss">
    <div class="modal-header pb-0">
        <h4 class="modal-title">Edit Image</h4>
        <a (click)="d('Cross click'); resetSelection()" aria-describedby="modal-title" class="close cursor-pointer">
            <span aria-hidden="true">&times;</span>
        </a>
    </div>
    <div class="modal-body d-flex flex-column">
        <div class="file-cropper-body w-100 d-flex flex-column">
            <image-cropper (cropperReady)="cropperReady()" (imageCropped)="imageCropped($event)"
                           (imageLoaded)="imageLoaded()" (loadImageFailed)="loadImageFailed()"
                           [aspectRatio]="aspectRatio"
                           [imageChangedEvent]="browsedFileEvent"
                           [maintainAspectRatio]="maintainAspectRatio" [resizeToHeight]="resizeToHeight"
                           [resizeToWidth]="resizeToWidth"
                           [transform]="transform" format="png" style="padding: 0px;">
            </image-cropper>
            <!-- [resizeToWidth]="resizeToWidth"
                [resizeToHeight]="resizeToHeight" -->

            <div class="w-100 my-2 text-center" *ngIf="hasImageLoadError">
                {{ imageLoadErrorMessage }}
            </div>
            <div *ngIf="uploadImageInProcess" class="fileUploader-new">
                <div class="controls upload-progress">
                    <div class="row">
                        <div class="col">
                            <div class="">
                                {{fileName}}
                            </div>
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" [style.width.%]="[loaderValue]"
                                     aria-valuenow="[loaderValue]" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer pr-0 pb-0">
                <div>
                    <a class="cursor-pointer" (click)="zoomIn()" style="padding-right: 15px;">
                        <img [src]="zoomInIconUrl" style="width: 24px;"></a>
                    <a class="cursor-pointer" (click)="zoomOut()" style="padding-right: 15px;">
                        <img [src]="zoomOutIconUrl" style="width: 24px;"></a>
                </div>
                <oc-button type="secondary" [disabled]="uploadImageInProcess"
                           (click)="d('Cross click'); resetSelection()" [text]="'Close'"></oc-button>
                <oc-button type="primary"
                           [disabled]="hasImageLoadError || uploadImageInProcess"
                           (click)="uploadImageFile();"
                           [process]="uploadImageInProcess" [text]="'Upload'"
                ></oc-button>
            </div>
        </div>
    </div>
    <div *ngIf="hasImageLoadError" class="w-100 my-2 text-center">
        {{ imageLoadErrorMessage }}
    </div>
    <div *ngIf="uploadImageInProcess" class="fileUploader-new">
        <div class="controls upload-progress">
            <div class="row">
                <div class="col">
                    <div class="">
                        {{fileName}}
                    </div>
                    <div class="progress">
                        <div [style.width.%]="[loaderValue]" aria-valuemax="100" aria-valuemin="0"
                             aria-valuenow="[loaderValue]" class="progress-bar" role="progressbar"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>
<!--end cropper modal for bulk edit-->

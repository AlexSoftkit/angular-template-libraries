<div (fileDropped)="onFileDropped($event,cropperModal)" *ngIf="(!fileDetailArr || fileDetailArr.length == 0) ;else fileList"
     class="file-container without-files"
     fileDragDrop>
    <img [src]="uploadIconUrl" alt="upload-icon"
         class="mb-2">
    <input #fileDropRef (change)="fileBrowseHandler($event,cropperModal)" [accept]="getAcceptTypes()" class="cursor-pointer"
           id="fileDropRef" type="file"/>
    <div class="placeholder-text-container">
        <span class="d-block text-secondary font-m">{{fileUploadText}}</span>
        <span class="text-secondary font-m">or</span> <a (click)="fileDropRef.click()"
                                                         class="font-m font-bold browse-file"> Browse File</a>
    </div>
</div>

<ng-template #fileList>
    <div class="file-container">
        <div class="row">
            <div class="col-md">
                <p class="mb-3 font-med font-m">My Attachments</p>
            </div>
            <div *ngIf="isMultiFileSupport()" class="col-md-auto">
                <img [src]="uploadIconUrl" alt="upload-icon"
                     class="upload-s">
                <a (click)="fileDropRef.click()" class="font-m font-bold browse-file">
                    <input #fileDropRef (change)="fileBrowseHandler($event,cropperModal)" [accept]="getAcceptTypes()"
                           style="display: none;" type="file"/>
                    Browse File
                </a>
                <!-- <a href="#" *ngIf="isMultiFile || (!files || files.length == 0)">
                  <input type="file" [accept]="acceptType" #fileUploadRefid (change)="fileBrowseHandler($event,cropperModal)" />
                  <h5 class="blue-label float-right" style="display: inline;">Browse file</h5>
                </a> -->
            </div>
        </div>

        <div *ngFor="let file of fileDetailArr; let i = index" class="row">
            <div class="col-md-auto pr-0">
                <img [ngClass]="getFileIconClass(file)" [src]="getUrl(file)" alt="app-icon">
            </div>
            <div *ngIf="file" class="col-md-auto ml-n1">
                <a (click)="downloadFile(file)" class="cursor-pointer"><span
                        class="font-med font-m d-block"> {{file.name}}</span></a>
                <span class="text-secondary font-s">{{file.fileUploadProgress === 100 ? "Complete" : "Uploading"}}</span>
            </div>
            <div *ngIf="file" class="col-md text-right pt-3">
                <a (click)="cancelUploading(i)" class="cursor-pointer">
                    <img alt="close-icon"
                         src="assets/img/close-icon.svg">
                </a>
            </div>
            <div class="col-12 pt-1 mb-2 progressbar-wrapper">
                <ngb-progressbar *ngIf="file?.fileUploadProgress == 100" [value]="file?.fileUploadProgress" class="file-upload-progress"
                                 type="info">
                </ngb-progressbar>
                <ngb-progressbar *ngIf="file?.fileUploadProgress &lt; 100" [value]="file?.fileUploadProgress" class="file-upload-progress"
                                 type="primary">
                </ngb-progressbar>
            </div>
            <!-- <div class="single-file" *ngFor="let file of files; let i = index">
              <div class="file-icon" style="width: 50px">
                <img [src]="getFileIcon(file)" style="max-width: 40px;">
              </div>
              <div class="info">
                <h4 class="name">
                  {{ file?.name }}
                </h4>
                <oc-label text="{{file?.fileUploadProgress < 100 ? 'Uploading' : 'Complete'}}" class="label-s"></oc-label>
                <p class="size">
                  {{ file?.size | fileSize }} - {{ fileDetail.uploadDate | date: 'dd MMM yyyy' }}
                </p>
                <p>
                  <ngb-progressbar type="primary" *ngIf="file?.fileUploadProgress < 100" [value]="file?.fileUploadProgress">
                  </ngb-progressbar>
                </p>
              </div>
              <div class="delete" (click)="deleteFile(i)">
                <span>X</span>
              </div>
              <hr>
            </div> -->
        </div>
    </div>
</ng-template>


<!--cropper modal for bulk edit-->
<ng-template #cropperModal let-c="close" let-d="dismiss">
    <div class="modal-header pb-0">
        <h4 class="modal-title">Edit Image</h4>
        <a (click)="d('Cross click'); resetSelection()" aria-describedby="modal-title" class="close cursor-pointer">
            <span aria-hidden="true">&times;</span>
        </a>
    </div>
    <div class="modal-body d-flex flex-column">
        <div class="file-cropper-body w-100 d-flex flex-column">
            <image-cropper (cropperReady)="cropperReady()" (imageCropped)="imageCropped($event)"
                           (imageLoaded)="imageLoaded()" (loadImageFailed)="loadImageFailed()" [aspectRatio]="aspectRatio"
                           [imageChangedEvent]="browsedFileEvent"
                           [maintainAspectRatio]="maintainAspectRatio" [resizeToHeight]="resizeToHeight"
                           [resizeToWidth]="resizeToWidth"
                           [transform]="transform" format="png" style="padding: 0px;">
            </image-cropper>
            <!-- [resizeToWidth]="resizeToWidth"
                [resizeToHeight]="resizeToHeight" -->

            <div *ngIf="hasImageLoadError" class="w-100 my-2 text-center">
                {{ imageLoadErrorMessage }}
            </div>
            <div *ngIf="uploadImageInProcess" class="fileUploader-new">
                <div class="controls upload-progress">
                    <div class="row">
                        <div class="col">
                            <div class="">
                                {{fileName}}
                            </div>
                            <div class="progress">
                                <div [style.width.%]="[loaderValue]" aria-valuemax="100" aria-valuemin="0"
                                     aria-valuenow="[loaderValue]" class="progress-bar" role="progressbar"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer pr-0 pb-0">
                <div style="padding-top: 15px;padding-right: 15px;">
                    <a (click)="zoomIn()" class="cursor-pointer" style="padding-right: 15px;"><i
                            class="fa fa-search-plus"></i></a>
                    <a (click)="zoomOut()" class="cursor-pointer"><i class="fa fa-search-minus"></i></a>
                </div>
                <oc-button (click)="d('Cross click'); resetSelection()" [disabled]="uploadImageInProcess"
                           [text]="'Close'" type="secondary"></oc-button>
                <oc-button (click)="uploadImageFile();" [disabled]="hasImageLoadError || uploadImageInProcess"
                           [disabled]="uploadImageInProcess"
                           [process]="uploadImageInProcess"
                           [text]="'Upload'" type="primary"
                ></oc-button>
            </div>
        </div>
    </div>
</ng-template>
<!--end cropper modal for bulk edit-->
